<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Perf report</title>
    <link rel="stylesheet" href="css/jquery-ui.css">
    <script src="js/jquery-1.9.1.js"></script>
    <script src="js/jquery-ui.js"></script>
    <link rel="stylesheet" href="css/style.css">
    <script type="text/javascript">
        function refreshSlider() {
            start = $("#slider-range").slider("values", 0)
            end = $("#slider-range").slider("values", 1)
            currentTime = parseInt($("#currentTime").val(), 10)

            startDate = new Date(currentTime + start * 1000 * 60)
            endDate = new Date(currentTime + end)
            $("#amount").val(startDate.toISOString() + " - " + endDate.toISOString());
            $("#start").val(start)
            $("#end").val(end)
        }
    </script>

    <script type="text/javascript">
        $(function () {
            $("#slider-range").slider({
                range: true,
                min: -24 * 60,
                max: 0,
                values: [ -60, 0],
                slide: function (event, ui) {
                    refreshSlider()
                }
            });
        });
    </script>
    <script type="text/javascript">

        function SendRequest() {
            start = $("#start").val();
            end = $("#end").val();
            $.ajax({
                url: "report.html",
                data: {start: start, end: end},
                cache: false,
                success: function (html) {
                    $("#dataReport").html(html);
                }
            });
        }
    </script>
    <script type="text/javascript">

        function refreshCurrentTime() {
            $.ajax({
                url: "currentTime",
                cache: false,
                success: function (html) {
                    $("#currentTime").val(html);
                    refreshSlider()
                }
            });
        }
        </script>
    <script  type="text/javascript">
        function onLoad() {
            setInterval(refreshCurrentTime, 1000)
        }

    </script>

</head>
<body onload="onLoad()">

<p>
    <label for="amount">Price range:</label>
    <input type="text" id="amount" style="border:0; color:#f6931f; font-weight:bold;" size="100" >
    </br>
    <input type="hidden" id="start">
    <input type="hidden" id="end">
    <input type="hidden" id="currentTime">
    <button onclick="SendRequest();">Послать запрос</button>
</p>

<div id="slider-range"></div>
</br>

<div id="dataReport"></div>


</body>
</html>